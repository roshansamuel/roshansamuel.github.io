<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script type='text/javascript' src='https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

    <title>Roshan Samuel - Projects</title>
<!--
Classic Template
http://www.templatemo.com/tm-488-classic
-->
    <!-- load stylesheets -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,400">  <!-- Google web font "Open Sans" -->
    <link rel="stylesheet" href="css/bootstrap.min.css">                                      <!-- Bootstrap style -->
    <link rel="stylesheet" href="css/templatemo-style.css">                                   <!-- Templatemo style -->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
        <!--[if lt IE 9]>
          <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
          <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
          <![endif]-->
</head>

    <body>
       
<!-- Top header with quick-links to other html pages -->
        <div class="tm-header">
            <div class="container-fluid">
                <div class="tm-header-inner">
                    <a href="index.html" class="navbar-brand tm-site-name">Roshan Samuel</a>
                    
                    <!-- navbar -->
                    <nav class="navbar tm-main-nav">

                        <button class="navbar-toggler hidden-md-up" type="button" data-toggle="collapse" data-target="#tmNavbar">
                            &#9776;
                        </button>
                        
                        <div class="collapse navbar-toggleable-sm" id="tmNavbar">
                            <ul class="nav navbar-nav">
                                <li class="nav-item">
                                    <a href="index.html" class="nav-link">Home</a>
                                </li>
                                <li class="nav-item">
                                    <a href="research.html" class="nav-link">Research</a>
                                </li>
                                <li class="nav-item">
                                    <a href="projects.html" class="nav-link">Projects</a>
                                </li>
                                <li class="nav-item">
                                    <a href="about.html" class="nav-link">About</a>
                                </li>
                            </ul>                        
                        </div>
                        
                    </nav>  

                </div>                                  
            </div>            
        </div>
<!-- End of top header with quick-links to other html pages -->


<!-- Image band at the top of home page -->
        <div class="tm-about-img-container">
            
        </div>
<!-- End image band at the top of home page -->

        <section class="tm-section">
            <div class="container-fluid">
                <div class="row tm-2-rows-sm-swap">
                    <div class="col-xs-12">
                        <h2 class="tm-gold-text">Blasius Profile</h3>
                        <p>
                        The <a href="https://en.wikipedia.org/wiki/Blasius_boundary_layer" target="_blank">Blasius profile</a> is a solution of the
                        Navier Stokes equations for a flow close to a semi-infinite flat plate.
                        Firstly, by assuming that the flat plate is infinitely long along the spanwise direction, we can ignore variations along one-dimension entirely.
                        Secondly, the flow is assumed steady, so that derivatives with respect to time are neglected as well.
                        This allows us to start off with the 2D steady-state Navier-Stokes equations:
                        </p>
                        $$
                        \frac{\partial u}{\partial x} + \frac{\partial v}{\partial y} = 0
                        $$
                        $$
                        u\frac{\partial u}{\partial x} + v\frac{\partial u}{\partial y} = -\frac{\partial p}{\partial x} + \nu\left(\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}\right)
                        $$
                        $$
                        u\frac{\partial v}{\partial x} + v\frac{\partial v}{\partial y} = -\frac{\partial p}{\partial y} + \nu\left(\frac{\partial^2 v}{\partial x^2} + \frac{\partial^2 v}{\partial y^2}\right)
                        $$
                        <p>
                        We use a scaling argument to assert that \(v \ll u\) and that variations of quantities along the \(x\) direction are much smaller than those along the \(y\) direction.
                        Moreover, we assume that the pressure gradient along the \(x\) direction is 0.
                        This allows us to reduce the above equations to the following equation for \(u\):
                        </p>
                        $$
                        u\frac{\partial u}{\partial x} + v\frac{\partial u}{\partial y} = \nu\frac{\partial^2 u}{\partial y^2}
                        $$
                        <p>
                        Let the free-stream velocity be \(U\) and let \(\delta\) be the boundary layer thickness.
                        Blasius established that \(\delta(x) \propto \sqrt{\nu x/U}\), and normalized the \(y\) coordinate as \(\eta(x) = y/\delta(x)\).
                        Subsequently we introduce a normalized stream-function \(\psi\) in terms of \(\eta\) as \(\psi = \sqrt{\nu U x} f(\eta)\).
                        Keeping in mind that \(u = \partial\psi/\partial y\) and that \(v = -\partial\psi/\partial x\), and with a bit of algebra, the above equation for \(u\) will
                        reduce to the Blasius ODE as
                        </p>
                        $$
                        2f''' + f''f = 0, \qquad \qquad f(0) = 0, \qquad \qquad f'(0) = 0, \qquad \qquad f'(\infty) = 1.
                        $$
                        <p>
                        When solving an ODE, there are two ways we can go about with it.
                        If we know the initial values of all the variables, we can start from these values and march forward in \(\eta\).
                        Such problems are called Initial Value Problems (IVP).
                        In other cases, we know the values of the variables at the boundaries of the domain, in which case we usually solve the equations iteratively.
                        Such problems are Boundary Value Problems (BVP).
                        Here we have a BVP, but one of the boundaries is at \(\infty\), and we use a method called
                        <a href="https://en.wikipedia.org/wiki/Shooting_method" target="_blank">shooting method</a> to solve it.
                        </p>
                        <p>
                        Now solving the Blasius ODE with shooting method using Python is the fun part.
                        By introducing two new variables, \(g\) and \(h\), as below, we first obtain a set of three ODEs.
                        </p>
                        $$
                        g = f', \qquad \qquad h = f''
                        $$
                        <p>
                        So the derivatives of these two new variables will be:
                        </p>
                        $$
                        g' = f'' = h, \qquad \qquad h' = f''' = -\frac{f''f}{2} = -\frac{hf}{2}.
                        $$
                        <p>
                        We now have a set of ODEs which can be solved simultaneously as below:
                        </p>
                        $$
                        \frac{\partial}{\partial \eta}
                        \begin{bmatrix}
                        f \\
                        g \\
                        h
                        \end{bmatrix}
                        =
                        \begin{bmatrix}
                        g \\
                        h \\
                        -hf/2
                        \end{bmatrix}
                        $$
                        <p>
                        In Python, this equation can be written as a simple function as below:
                        </p>
<pre>

    def blasiusEqn(eta, y):
        f, g, h = y
        return g, h, -h*f/2

</pre>
                        <p>
                        This is an example of a non-autonomous ODE, since the variable of differentiation, \(\eta\) does not appear in the equations.
                        However, for the ODE solving functions of SciPy module to be used later, the variable of differentiation must also be defined as an argument of the function.
                        Hence, <code>eta</code> has also been included as a parameter, although it is not used anywhere in the function.
                        Moreover, the variables \(f\), \(g\) and \(h\) have been packed together into a single vector <code>y</code>, for convenience.
                        </p>
                        <p>
                        Now we need to integrate the ODE using an integrating function of SciPy.
                        For this, we will use the <code>RK45</code> function from <code>scipy.integrate</code>.
                        We need to pass the initial value of \(\eta\) (which is 0), along with the initial values of \(f\), \(g\) and \(h\).
                        Now we know the initial values of \(f\) and \(g\), but not that of \(h\).
                        </p>
                        <p>
                        But what if we guessed an initial value for \(h\)?
                        To do that, we will first represent these initial values as <code>f0</code>, <code>g0</code> and <code>h0</code> in the code.
                        Then we write a function that already knows the values of <code>f0</code> and <code>g0</code> to be 0, but accepts a guessed value of <code>h0</code> as an argument.
                        It then solves the ODE using this guessed value for a reasonably large number of steps
                        (since we can't compute all the way up to infinity, we are content with using a sufficiently large value as an approximation).
                        After solving, we check the value of <code>g</code> (which is <code>y[1]</code> since we packed <code>f</code>, <code>g</code> and <code>h</code>
                        into a single variable <code>y</code>) and see how close it is to the expected value of 1 at infinity.
                        </p>
<pre>

    import scipy.integrate as integrate

    def findh0(h0):
        f0, g0 = 0, 0
        initVals = np.array([f0, g0, h0], dtype=object)
        res = integrate.RK45(blasiusEqn, 0, initVals, 100)
        for i in range(100):
            res.step()

        return 1 - res.y[1]

</pre>
                        <p>
                        Note that the function subtracts 1 from the value of <code>res.y[1]</code> (aka \(f'(\infty)\)) so that with the correct value of <code>h0</code> when \(f'(\infty) = g = 1\), the code will output 0.
                        Let us now test the above function by passing a series of possible values for <code>h0</code>, that is, \(f''(0)\).
                        We will pass 9 values from 0.1 to 0.9, at increments of 0.1 in a <code>for</code> loop as below:
                        </p>
<pre>

    for i in range(1, 10):
        print(i/10, findh0(i/10))

</pre>
                        <p>
                        When we run the above code, we get the following output:
                        </p>
<pre>

    0.1 0.5506351233427067
    0.2 0.2866459873213928
    0.3 0.06532864818390183
    0.4 -0.13224447107866233
    0.5 -0.3138520833820062
    0.6 -0.4836714704127618
    0.7 -0.6442724624772207
    0.8 -0.7973778017977666
    0.9 -0.9442182127881427

</pre>
                        <p>
                        We see that somewhere between 0.3 and 0.4, the output of the function changes sign from positive to negative!
                        This is close to the expected value of 0.332, and we must now try to get this value using a non-linear solver.
                        We will employ the next useful SciPy function for our task - <code>fsolve</code> from <code>scipy.optimize</code>.
                        This makes our task so absurdly simple, that we only need to pass the function, <code>findh0</code>,
                        and an initial guessed value, for which we choose 0.3, since we just found that to be pretty close to the root of the function.
                        Thus we find the expected value with just a one-line code.
                        </p>
<pre>

    import scipy.optimize as optimize

    h0 = optimize.fsolve(findh0, 0.3)
    print(h0[0])

</pre>
                        <p>
                        This will very nicely print the expected value of <code>h0</code> as 0.332 which is indeed the expected value.
                        Putting it all together, we can now solve the Blasius equation and plot the resulting velocity profile with a short Python code:
                        </p>
<pre>

    import matplotlib.pyplot as plt

    def blasius():
        f0, g0 = 0, 0
        h0 = optimize.fsolve(findh0, 0.3)
        initVals = np.array([f0, g0, h0], dtype=object)
        res = integrate.solve_ivp(blasiusEqn, (0, 10), initVals, max_step=0.01)

        eta = res.t
        g = res.y[1]

        # Now plot the profile
        fig = plt.figure(figsize=(7.5, 9))
        ax = fig.add_subplot(1, 1, 1)

        ax.plot(g, eta, linewidth=3, color='r')

        ax.set_xlim(0, 1.2)
        ax.set_ylim(0, 10)
        ax.set_xlabel(r"$f'$", fontsize=35)
        ax.set_ylabel(r"$\eta$", fontsize=35)
        ax.tick_params(axis='both', which='major', labelsize=30)

        plt.tight_layout()
        plt.show()

    blasius()

</pre>
                        <p>
                        Two things to note in the above code are that (a) we use the function <code>solve_ivp</code> instead of <code>RK45</code> because it gives finer control
                        on the spacing of points in the final result so that we get a neat-looking plot, and (b) we are actually plotting \(g = f'(\eta)\) because \(f\) is merely
                        the non-dimensional stream-function. The actual velocity profile is given by its derivative.
                        Finally we see Blasius profile in the flesh:
                        <div class="col-xs-12">
                            <img src="resources/blProfile.png" alt="Image" class="img-fluid tm-img-post">
                        </div>
                        </p>
                    </div>
                </div>

            </div>
        </section>
        
        <footer class="tm-footer">
            <div class="container-fluid">
                <div class="row">
                    
                <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6 col-xl-6">
                    <div class="tm-footer-content-box">
                        <h3 class="tm-gold-text tm-title tm-footer-content-box-title">About the Page</h3>
                        <div class="tm-gray-bg">
                            <p>Classic HTML CSS website template provided by templatemo</p>
                            <p>
                            Downloaded from <a href="http://www.free-css.com/free-css-templates/page223/classic" target="_blank" class="nav-link">Free-CSS</a>
                            </p>
                        </div>    
                    </div>
                </div>

                <div class="col-xs-6 col-sm-3 col-md-3 col-lg-3 col-xl-3">
                    <div class="tm-footer-content-box tm-footer-links-container">
                    
                        <h3 class="tm-gold-text tm-title tm-footer-content-box-title">Jump To</h3>
                        <nav>
                            <ul class="nav">
                                <li><a href="index.html" class="tm-footer-link">Home</a></li>
                                <li><a href="research.html" class="tm-footer-link">Research</a></li>
                                <li><a href="projects.html" class="tm-footer-link">Projects</a></li>
                                <li><a href="about.html" class="tm-footer-link">About</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>

                <div class="col-xs-6 col-sm-3 col-md-3 col-lg-3 col-xl-3">
                    <div class="tm-footer-content-box tm-footer-links-container">
                    
                        <h3 class="tm-gold-text tm-title tm-footer-content-box-title">Quicklinks</h3>
                        <nav>
                            <ul class="nav">
                                <li><a href="https://www.iitk.ac.in/" target="_blank" class="tm-footer-link">IITK Homepage</a></li>
                                <li><a href="https://www.iitk.ac.in/me/" target="_blank" class="tm-footer-link">ME Department</a></li>
                                <li><a href="https://turbulencehub.org/" target="_blank" class="tm-footer-link">Lab Website</a></li>
                                <li><a href="https://scholar.google.co.in/citations?user=LLwzMe8AAAAJ" target="_blank" class="tm-footer-link">Google Scholar</a></li>
                                <li><a href="https://github.com/roshansamuel" target="_blank" class="tm-footer-link">GitHub</a></li>
                            </ul>
                        </nav>
                    </div>
                </div>

                </div>

                <div class="row">
                    <div class="col-xs-12 tm-copyright-col">
                        <p class="tm-copyright-text">Copyright 2021 Roshan Samuel</p>
                    </div>
                </div>
            </div>
        </footer>

        <!-- load JS files -->
        <script src="js/jquery-1.11.3.min.js"></script>             <!-- jQuery (https://jquery.com/download/) -->
        <script src="https://www.atlasestateagents.co.uk/javascript/tether.min.js"></script> <!-- Tether for Bootstrap, http://stackoverflow.com/questions/34567939/how-to-fix-the-error-error-bootstrap-tooltips-require-tether-http-github-h --> 
        <script src="js/bootstrap.min.js"></script>                 <!-- Bootstrap (http://v4-alpha.getbootstrap.com/) -->
</body>
</html>
